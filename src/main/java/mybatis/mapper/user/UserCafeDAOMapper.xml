<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">


<!-- 사용자페이지 - 카페정보 -->
<mapper namespace="com.coffice.user.service.CafeImpl">

	<select id="getCafeData" resultType="com.coffice.dto.StoresDTO">

		Select * from stores where store_idx=#{store_idx}

	</select>
	
	<select id="check_jjim" resultType="int">
		SELECT count(*) FROM jjim where mem_id=#{_id} and store_idx=#{_idx}
	</select>
	
	<delete id="delete_jjim">
	  DELETE from jjim where mem_id=#{_id} and store_idx=#{_idx}   
   </delete>
   <insert id="insert_jjim">
	  insert into jjim(jjim_idx , store_idx , mem_id , jjim_flag , jjim_postdate) values(jjim_seq.nextval, #{_idx}, #{_id}, 1, sysdate)   
   </insert>
     <update id="storeInsert_jjim">
   	  update stores set JJIM_HIT = JJIM_HIT + 1 where STORE_IDX=#{_idx}
   </update>
   
   <update id="storeDelete_jjim" >
   	  update stores set JJIM_HIT = JJIM_HIT - 1 where STORE_IDX=#{_idx}
   </update>

</mapper>